import tensorflow as tf


class BlosumInitializer(tf.keras.initializers.Initializer):
    """
    A class used to initialize BLOSUM (BLOcks SUbstitution Matrix) for protein sequences.

    This class inherits from the Initializer class in TensorFlow's Keras API. It overrides the __init__ method to
    accept two additional parameters: cluster_pc and reorder_vocab.

    Attributes
    ----------
    cluster_pc : int
        The BLOSUM matrix sequence similarity. Valid options are 45, 50, 62, 80 and 90.
    reorder_vocab : list
        Users can ignore this argument if their language model vocab is ordered and contains
        no special tokens.

        If specified, must be a list of integers specifying the positions of the ordered amino acids. For example,
        the first entry of the list should be an integer indicating where alanine (A) is.
        This is necessary because the BLOSUM matrix default vocabulary is the
        sorted amino acid residues.

    Methods
    -------
    __init__(self, cluster_pc, reorder_vocab):
        Constructs all the necessary attributes for the BlosumInitializer object.
    """

    def __init__(self, cluster_pc: int, reorder_vocab: list):
        """
        Constructs all the necessary attributes for the BlosumInitializer object.

        Parameters
        ----------
        cluster_pc : int
            The BLOSUM matrix sequence similarity. Valid options are 45, 50, 62, 80 and 90.
        reorder_vocab : list
            Users can ignore this argument if their language model vocab is ordered and contains
            no special tokens.

            If specified, must be a list of integers specifying the positions of the ordered amino acids. For example,
            the first entry of the list should be an integer indicating where alanine (A) is.
            This is necessary because the BLOSUM matrix default vocabulary is the
            sorted amino acid residues.
        """
        self.cluster_pc = cluster_pc

        # Cast all entries in reorder vocab to int
        if reorder_vocab is not None:
            reorder_vocab = [
                int(pos) if not isinstance(pos, int) else pos for pos in reorder_vocab
            ]

            # Check reorder vocab input is acceptable
            if set(reorder_vocab) != set(range(20)):
                raise ValueError(
                    "1:1 mapping between AA letter and position required. Integers are missing"
                )

            if len(reorder_vocab) != 20:
                raise ValueError(
                    "`reorder_vocab` list must be length 20, since there are 20 amino acids."
                )

            if max(reorder_vocab) > 19:
                raise ValueError(
                    "Only 20 possible positions available. Please check `reorder_vocab`."
                )

        self.reorder_vocab = reorder_vocab

    def __call__(self, shape, dtype=None):
        """
        Call the initializer instance.

        This method is called when the initializer instance is "called" like a function. It returns an array of the
        specified shape and data type, filled with values from the BLOSUM probability matrix.

        Parameters
        ----------
        shape : tuple of int
            The shape of the array to return.
        dtype : str, optional
            The desired data type of the array. If not provided, the default data type is used.

        Returns
        -------
        array
            An array of the specified shape and data type, filled with values from the BLOSUM matrix.

        Raises
        ------
        ValueError
            If self.cluster_pc is not 45, 50, 62, 80 or 90.

        Notes
        -----
        This method is used to initialize the weights of a Blosum Probability matrix.
        """
        if self.cluster_pc == 45:
            prob_matrix = tf.constant(
                [
                    [
                        4.80889140e-01,
                        4.97193503e-03,
                        4.08073304e-02,
                        1.46560103e-02,
                        2.15628924e-02,
                        8.33883418e-02,
                        6.84767529e-03,
                        1.20222285e-02,
                        8.68968825e-03,
                        2.24767297e-02,
                        1.09113817e-02,
                        1.48530960e-02,
                        1.87231427e-02,
                        6.87112463e-03,
                        3.29144503e-02,
                        7.79384410e-02,
                        3.59170387e-02,
                        3.76907197e-02,
                        1.06800930e-02,
                        5.71885407e-02,
                    ],
                    [
                        7.37362201e-02,
                        5.52009187e-01,
                        3.53955835e-02,
                        8.98900567e-03,
                        2.64504402e-02,
                        3.61648138e-02,
                        5.93955693e-03,
                        7.37362201e-03,
                        5.32966718e-03,
                        1.94959326e-02,
                        9.46434670e-03,
                        1.28833225e-02,
                        8.12006757e-03,
                        4.21428322e-03,
                        2.85494337e-02,
                        4.78021695e-02,
                        3.11538277e-02,
                        3.26922884e-02,
                        4.63186539e-03,
                        4.96043663e-02,
                    ],
                    [
                        3.03640651e-02,
                        1.77588721e-03,
                        6.59618907e-01,
                        2.96128826e-02,
                        7.70188359e-03,
                        4.21221248e-02,
                        9.78347375e-03,
                        3.03640651e-03,
                        8.77888023e-03,
                        8.02829011e-03,
                        3.89735247e-03,
                        3.00110999e-02,
                        1.33751505e-02,
                        6.94165066e-03,
                        3.32522881e-02,
                        3.93692052e-02,
                        1.81428477e-02,
                        9.51939541e-03,
                        3.81474023e-03,
                        4.08534695e-02,
                    ],
                    [
                        7.50828020e-02,
                        3.10513823e-03,
                        2.03884244e-01,
                        2.07112464e-01,
                        1.90448478e-02,
                        5.20787835e-02,
                        1.71064008e-02,
                        7.50828020e-03,
                        2.17079934e-02,
                        1.98519702e-02,
                        9.63718602e-03,
                        2.62371994e-02,
                        3.30734298e-02,
                        2.42749480e-02,
                        8.22246610e-02,
                        6.88370430e-02,
                        3.17227636e-02,
                        1.66446599e-02,
                        9.43290642e-03,
                        7.14322786e-02,
                    ],
                    [
                        3.07696713e-02,
                        2.54503243e-03,
                        1.47703594e-02,
                        5.30479540e-03,
                        4.99505031e-01,
                        2.13423981e-02,
                        4.95708118e-03,
                        1.23078685e-02,
                        3.14526378e-03,
                        3.25421312e-02,
                        1.11706288e-02,
                        7.60299777e-03,
                        6.77690855e-03,
                        1.75859448e-03,
                        2.38270063e-02,
                        1.99475515e-02,
                        1.83852017e-02,
                        2.72845819e-02,
                        2.18676896e-02,
                        2.34189207e-01,
                    ],
                    [
                        6.25084448e-02,
                        1.82794937e-03,
                        4.24347742e-02,
                        7.62025452e-03,
                        1.12114228e-02,
                        6.93711727e-01,
                        5.03514372e-03,
                        3.12542224e-03,
                        4.51812157e-03,
                        8.26364860e-03,
                        5.67327017e-03,
                        1.54454548e-02,
                        9.73492172e-03,
                        3.57257654e-03,
                        2.42022264e-02,
                        4.05233584e-02,
                        1.32050254e-02,
                        9.79846735e-03,
                        7.85314738e-03,
                        2.97346431e-02,
                    ],
                    [
                        3.78177825e-02,
                        2.21182888e-03,
                        7.26146512e-02,
                        1.84411005e-02,
                        1.91850569e-02,
                        3.70963702e-02,
                        3.89923318e-01,
                        5.34824209e-03,
                        7.73143789e-03,
                        1.41408072e-02,
                        1.37293768e-02,
                        2.64303588e-02,
                        1.17793093e-02,
                        1.22268306e-02,
                        5.85696566e-02,
                        3.46719122e-02,
                        1.59781540e-02,
                        1.18561999e-02,
                        6.71917747e-03,
                        2.03528429e-01,
                    ],
                    [
                        8.70429116e-02,
                        3.59976274e-03,
                        2.95451784e-02,
                        1.06111925e-02,
                        6.24475550e-02,
                        3.01872655e-02,
                        7.01142977e-03,
                        1.39268659e-01,
                        6.29147722e-03,
                        9.20569421e-02,
                        4.46892609e-02,
                        1.52082912e-02,
                        1.91708857e-02,
                        7.03543988e-03,
                        3.37015625e-02,
                        3.99011258e-02,
                        3.67759545e-02,
                        1.54368204e-01,
                        1.54651260e-02,
                        1.65621776e-01,
                    ],
                    [
                        7.99074632e-02,
                        3.30466782e-03,
                        1.08492706e-01,
                        3.89653084e-02,
                        2.02686293e-02,
                        5.54252555e-02,
                        1.28733186e-02,
                        7.99074632e-03,
                        9.24116117e-02,
                        1.49394803e-02,
                        1.45048122e-02,
                        2.79231460e-02,
                        2.48892099e-02,
                        1.82679655e-02,
                        2.47510688e-01,
                        5.18029009e-02,
                        3.37612009e-02,
                        2.50516765e-02,
                        1.41973535e-02,
                        1.07511860e-01,
                    ],
                    [
                        8.26847462e-02,
                        4.83593954e-03,
                        3.96911427e-02,
                        1.42551299e-02,
                        8.38923625e-02,
                        4.05537258e-02,
                        9.41919035e-03,
                        4.67735558e-02,
                        5.97646824e-03,
                        2.47339527e-01,
                        4.24517071e-02,
                        1.02154478e-02,
                        1.28771326e-02,
                        6.68318132e-03,
                        4.52748502e-02,
                        2.68016875e-02,
                        3.49346133e-02,
                        7.33195589e-02,
                        1.46908001e-02,
                        1.57329233e-01,
                    ],
                    [
                        8.09691000e-02,
                        4.73559744e-03,
                        3.88675814e-02,
                        1.39593467e-02,
                        5.80899952e-02,
                        5.61616258e-02,
                        1.84474985e-02,
                        4.58030397e-02,
                        1.17049220e-02,
                        8.56332538e-02,
                        1.66283465e-01,
                        1.41470641e-02,
                        1.78331507e-02,
                        1.30890207e-02,
                        6.26997680e-02,
                        3.71168448e-02,
                        3.42097464e-02,
                        7.17982332e-02,
                        1.43859771e-02,
                        1.54064770e-01,
                    ],
                    [
                        7.00445067e-02,
                        4.09665646e-03,
                        1.90202962e-01,
                        2.41518197e-02,
                        2.51261596e-02,
                        9.71682624e-02,
                        2.25687367e-02,
                        9.90578913e-03,
                        1.43198442e-02,
                        1.30955043e-02,
                        8.99050012e-03,
                        1.95812797e-01,
                        1.54270486e-02,
                        1.13230108e-02,
                        7.67071242e-02,
                        9.08177657e-02,
                        4.18523282e-02,
                        1.55277502e-02,
                        6.22248900e-03,
                        6.66389451e-02,
                    ],
                    [
                        5.92023278e-02,
                        1.73126780e-03,
                        5.68377639e-02,
                        2.04133631e-02,
                        1.50167454e-02,
                        4.10638007e-02,
                        6.74414593e-03,
                        8.37247348e-03,
                        8.55830968e-03,
                        1.10684531e-02,
                        7.59886193e-03,
                        1.03439352e-02,
                        5.90082218e-01,
                        6.76724074e-03,
                        3.24168198e-02,
                        3.83800486e-02,
                        2.50132041e-02,
                        1.31242120e-02,
                        7.43778872e-03,
                        3.98270205e-02,
                    ],
                    [
                        8.45841162e-02,
                        3.49807634e-03,
                        1.14842335e-01,
                        5.83303509e-02,
                        1.51708828e-02,
                        5.86690662e-02,
                        2.72534813e-02,
                        1.19620004e-02,
                        2.44550202e-02,
                        2.23641275e-02,
                        2.17134375e-02,
                        2.95573722e-02,
                        2.63458723e-02,
                        1.09387235e-01,
                        1.30998232e-01,
                        7.75479909e-02,
                        3.57371043e-02,
                        1.87509498e-02,
                        1.50282658e-02,
                        1.13804084e-01,
                    ],
                    [
                        3.44036381e-02,
                        2.01214760e-03,
                        4.67108283e-02,
                        1.67762599e-02,
                        1.74530527e-02,
                        3.37473540e-02,
                        1.10850470e-02,
                        4.86540915e-03,
                        2.81338115e-02,
                        1.28641919e-02,
                        8.83169650e-03,
                        1.70018575e-02,
                        1.07158873e-02,
                        1.11230069e-02,
                        6.02817668e-01,
                        3.15417732e-02,
                        2.05565349e-02,
                        1.52534759e-02,
                        8.64449087e-03,
                        6.54618686e-02,
                    ],
                    [
                        1.39070938e-01,
                        5.75144342e-03,
                        9.44103455e-02,
                        2.39763001e-02,
                        2.49435592e-02,
                        9.64621071e-02,
                        1.12023610e-02,
                        9.83380035e-03,
                        1.00520723e-02,
                        1.30003347e-02,
                        8.92516306e-03,
                        3.43635791e-02,
                        2.16585887e-02,
                        1.12407226e-02,
                        5.38459460e-02,
                        2.55004659e-01,
                        8.30963457e-02,
                        3.08298093e-02,
                        6.17726803e-03,
                        6.61546569e-02,
                    ],
                    [
                        1.02650359e-01,
                        6.00365790e-03,
                        6.96857013e-02,
                        1.76972691e-02,
                        3.68224351e-02,
                        5.03461001e-02,
                        8.26863175e-03,
                        1.45169530e-02,
                        1.04928796e-02,
                        2.71408607e-02,
                        1.31755952e-02,
                        2.53642765e-02,
                        2.26083694e-02,
                        8.29694705e-03,
                        5.62072188e-02,
                        1.33093610e-01,
                        2.45338669e-01,
                        4.55118954e-02,
                        9.11906957e-03,
                        9.76595019e-02,
                    ],
                    [
                        1.12702170e-01,
                        6.59155291e-03,
                        3.82547602e-02,
                        9.71511762e-03,
                        5.71740962e-02,
                        3.90861272e-02,
                        6.41934116e-03,
                        6.37539748e-02,
                        8.14613298e-03,
                        5.95971396e-02,
                        2.89315728e-02,
                        9.84576101e-03,
                        1.24111221e-02,
                        4.55470367e-03,
                        4.36363989e-02,
                        5.16635228e-02,
                        4.76170866e-02,
                        2.82664791e-01,
                        1.00120344e-02,
                        1.07222594e-01,
                    ],
                    [
                        9.44647564e-03,
                        2.76245542e-04,
                        4.53458987e-03,
                        1.62860435e-03,
                        1.35544479e-02,
                        9.26627461e-03,
                        1.07611326e-03,
                        1.88929513e-03,
                        1.36558590e-03,
                        3.53222167e-03,
                        1.71472538e-03,
                        1.16708320e-03,
                        2.08055201e-03,
                        1.07979833e-03,
                        7.31503538e-03,
                        3.06200961e-03,
                        2.82218419e-03,
                        2.96155131e-03,
                        8.59329700e-01,
                        7.18975064e-02,
                    ],
                    [
                        1.77751553e-02,
                        1.03960622e-03,
                        1.70652087e-02,
                        4.33385306e-03,
                        5.10100118e-02,
                        1.23291678e-02,
                        1.14545114e-02,
                        7.11006212e-03,
                        3.63393886e-03,
                        1.32929552e-02,
                        6.45309662e-03,
                        4.39213226e-03,
                        3.91491351e-03,
                        2.87343413e-03,
                        1.94659240e-02,
                        1.15233868e-02,
                        1.06208419e-02,
                        1.11453279e-02,
                        2.52652409e-02,
                        7.65301232e-01,
                    ],
                ]
            )

        elif self.cluster_pc == 50:
            prob_matrix = tf.constant(
                [
                    [
                        4.88721902e-01,
                        5.05291832e-03,
                        4.14720036e-02,
                        1.48947286e-02,
                        1.54956162e-02,
                        8.47465780e-02,
                        6.95921079e-03,
                        1.22180476e-02,
                        8.83122662e-03,
                        1.61523218e-02,
                        1.10891072e-02,
                        1.50950245e-02,
                        1.90281068e-02,
                        6.98304208e-03,
                        3.34505636e-02,
                        7.92079089e-02,
                        3.65020585e-02,
                        3.83046292e-02,
                        7.67497324e-03,
                        5.81200324e-02,
                    ],
                    [
                        6.07895688e-02,
                        6.43590308e-01,
                        2.06339450e-02,
                        7.41071047e-03,
                        2.18062555e-02,
                        2.98149733e-02,
                        4.89668583e-03,
                        8.59694326e-03,
                        4.39388090e-03,
                        1.60728246e-02,
                        7.80259083e-03,
                        1.06212607e-02,
                        6.69434106e-03,
                        3.47433675e-03,
                        1.66429647e-02,
                        3.94090349e-02,
                        2.56838193e-02,
                        2.69521560e-02,
                        3.81859959e-03,
                        4.08948008e-02,
                    ],
                    [
                        2.45682474e-02,
                        1.01604898e-03,
                        7.54783428e-01,
                        2.39604488e-02,
                        4.40652477e-03,
                        3.40819577e-02,
                        5.59747741e-03,
                        2.45682474e-03,
                        5.02271331e-03,
                        4.59327368e-03,
                        2.22981560e-03,
                        2.42826553e-02,
                        1.08221349e-02,
                        5.61664554e-03,
                        1.90248307e-02,
                        3.18545086e-02,
                        1.46797858e-02,
                        5.44638868e-03,
                        2.18255016e-03,
                        2.33737401e-02,
                    ],
                    [
                        7.92946181e-02,
                        3.27932288e-03,
                        2.15321257e-01,
                        2.18730566e-01,
                        2.01131803e-02,
                        3.88909968e-02,
                        1.80659949e-02,
                        5.60697622e-03,
                        2.29257167e-02,
                        1.48249029e-02,
                        1.01777899e-02,
                        2.77089913e-02,
                        2.46983237e-02,
                        2.56366662e-02,
                        8.68371041e-02,
                        5.14056019e-02,
                        3.35022716e-02,
                        1.75783524e-02,
                        9.96205113e-03,
                        7.54393164e-02,
                    ],
                    [
                        2.07894262e-02,
                        2.43180062e-03,
                        9.97954425e-03,
                        5.06877814e-03,
                        4.77281401e-01,
                        1.44199204e-02,
                        6.69847087e-03,
                        1.17602754e-02,
                        2.12508703e-03,
                        3.10942894e-02,
                        1.06736330e-02,
                        3.63236525e-03,
                        4.57879576e-03,
                        1.68035232e-03,
                        1.60986377e-02,
                        1.34774969e-02,
                        1.24219005e-02,
                        1.84347371e-02,
                        2.08947676e-02,
                        3.16458320e-01,
                    ],
                    [
                        4.93947197e-02,
                        1.44446158e-03,
                        3.35323297e-02,
                        4.25790836e-03,
                        6.26451661e-03,
                        7.75239451e-01,
                        3.97881460e-03,
                        2.46973598e-03,
                        3.57025917e-03,
                        4.61741251e-03,
                        3.17000757e-03,
                        1.22051334e-02,
                        7.69262028e-03,
                        2.82308122e-03,
                        1.35232835e-02,
                        3.20219122e-02,
                        1.04347265e-02,
                        5.47501084e-03,
                        4.38804004e-03,
                        2.34965750e-02,
                    ],
                    [
                        3.87207985e-02,
                        2.26464311e-03,
                        5.25723636e-02,
                        1.88814386e-02,
                        2.77796221e-02,
                        3.79821603e-02,
                        3.99233938e-01,
                        3.87207985e-03,
                        1.11949850e-02,
                        1.02378190e-02,
                        9.93994705e-03,
                        2.70614650e-02,
                        1.20605766e-02,
                        1.25187839e-02,
                        5.99681875e-02,
                        3.54998109e-02,
                        1.63596816e-02,
                        8.58378357e-03,
                        6.87961852e-03,
                        2.08388297e-01,
                    ],
                    [
                        8.94082963e-02,
                        5.22917631e-03,
                        3.03480665e-02,
                        7.70714634e-03,
                        6.41445627e-02,
                        3.10076022e-02,
                        5.09255819e-03,
                        1.43053274e-01,
                        6.46244765e-03,
                        9.45585827e-02,
                        4.59036882e-02,
                        1.10461219e-02,
                        1.39242429e-02,
                        5.10999726e-03,
                        2.44781983e-02,
                        2.89810797e-02,
                        3.77753383e-02,
                        2.24242155e-01,
                        1.12326667e-02,
                        1.20294799e-01,
                    ],
                    [
                        8.09035643e-02,
                        3.34586276e-03,
                        7.76722446e-02,
                        3.94510376e-02,
                        1.45107444e-02,
                        5.61161691e-02,
                        1.84325673e-02,
                        8.09035643e-03,
                        1.32318892e-01,
                        1.51257111e-02,
                        1.03843048e-02,
                        2.82712271e-02,
                        2.51994709e-02,
                        2.61568531e-02,
                        2.50596078e-01,
                        7.41736055e-02,
                        3.41820574e-02,
                        1.79350301e-02,
                        1.01641885e-02,
                        7.69700357e-02,
                    ],
                    [
                        6.51933303e-02,
                        5.39229483e-03,
                        3.12947417e-02,
                        1.12395506e-02,
                        9.35438395e-02,
                        3.19748510e-02,
                        7.42662239e-03,
                        5.21546642e-02,
                        6.66403674e-03,
                        2.75794939e-01,
                        6.69426536e-02,
                        8.05443678e-03,
                        1.01530596e-02,
                        7.45205429e-03,
                        3.56972525e-02,
                        2.98851132e-02,
                        3.89536993e-02,
                        8.17546776e-02,
                        1.63809173e-02,
                        1.24047265e-01,
                    ],
                    [
                        7.71094781e-02,
                        4.50986175e-03,
                        2.61734499e-02,
                        1.32939348e-02,
                        5.53209708e-02,
                        3.78192686e-02,
                        1.24225553e-02,
                        4.36197079e-02,
                        7.88210072e-03,
                        1.15330957e-01,
                        2.23950747e-01,
                        1.34727041e-02,
                        1.20088532e-02,
                        1.24650954e-02,
                        4.22220571e-02,
                        3.53475651e-02,
                        3.25790418e-02,
                        6.83757668e-02,
                        1.93750492e-02,
                        1.46720836e-01,
                    ],
                    [
                        6.73931706e-02,
                        3.94158915e-03,
                        1.83003368e-01,
                        2.32376211e-02,
                        1.20875401e-02,
                        9.34902335e-02,
                        2.17144612e-02,
                        6.73931706e-03,
                        1.37778071e-02,
                        8.90941187e-03,
                        8.65019024e-03,
                        2.66439051e-01,
                        1.48431015e-02,
                        1.08944104e-02,
                        5.21870215e-02,
                        8.73801168e-02,
                        4.02681270e-02,
                        1.49399912e-02,
                        5.98695433e-03,
                        6.41165168e-02,
                    ],
                    [
                        4.87482667e-02,
                        1.42555720e-03,
                        4.68012420e-02,
                        1.18855684e-02,
                        8.74341749e-03,
                        3.38126756e-02,
                        5.55325165e-03,
                        4.87482667e-03,
                        7.04706687e-03,
                        6.44454597e-03,
                        4.42439559e-03,
                        8.51738319e-03,
                        6.87144256e-01,
                        5.57226834e-03,
                        1.88745152e-02,
                        3.16028256e-02,
                        2.05963243e-02,
                        1.08067134e-02,
                        4.33061160e-03,
                        3.27942885e-02,
                    ],
                    [
                        7.99350460e-02,
                        3.30580853e-03,
                        1.08530156e-01,
                        5.51242891e-02,
                        1.43370324e-02,
                        5.54443874e-02,
                        2.57555245e-02,
                        7.99350460e-03,
                        3.26837167e-02,
                        2.11349085e-02,
                        2.05199829e-02,
                        2.79327846e-02,
                        2.48978012e-02,
                        1.46194171e-01,
                        1.23798062e-01,
                        7.32856533e-02,
                        3.37728548e-02,
                        1.77203250e-02,
                        2.00850205e-02,
                        1.07548971e-01,
                    ],
                    [
                        3.62970519e-02,
                        1.50110759e-03,
                        3.48473336e-02,
                        1.76995460e-02,
                        1.30203718e-02,
                        2.51762888e-02,
                        1.16951157e-02,
                        3.62970519e-03,
                        2.96821637e-02,
                        9.59697792e-03,
                        6.58864518e-03,
                        1.26837699e-02,
                        7.99429408e-03,
                        1.17351647e-02,
                        6.35993907e-01,
                        3.32776835e-02,
                        2.16878696e-02,
                        1.13794377e-02,
                        6.44898556e-03,
                        6.90645808e-02,
                    ],
                    [
                        1.28347303e-01,
                        5.30795476e-03,
                        8.71304482e-02,
                        1.56465117e-02,
                        1.62777279e-02,
                        8.90240004e-02,
                        1.03385569e-02,
                        6.41736513e-03,
                        1.31196111e-02,
                        1.19978905e-02,
                        8.23695172e-03,
                        3.17138342e-02,
                        1.99885143e-02,
                        1.03739605e-02,
                        4.96939333e-02,
                        3.32823110e-01,
                        7.66888608e-02,
                        2.01189913e-02,
                        5.70094442e-03,
                        6.10535305e-02,
                    ],
                    [
                        1.06859429e-01,
                        6.24983156e-03,
                        7.25430900e-02,
                        1.84229269e-02,
                        2.71050295e-02,
                        5.24104888e-02,
                        8.60767827e-03,
                        1.51122053e-02,
                        1.09231290e-02,
                        2.82537431e-02,
                        1.37158466e-02,
                        2.64043119e-02,
                        2.35354017e-02,
                        8.63715461e-03,
                        5.85119366e-02,
                        1.38550973e-01,
                        2.55398522e-01,
                        4.73780626e-02,
                        9.49298740e-03,
                        7.18872520e-02,
                    ],
                    [
                        1.18033704e-01,
                        6.90337559e-03,
                        2.83298481e-02,
                        1.01747049e-02,
                        4.23407036e-02,
                        2.89455232e-02,
                        4.75389100e-03,
                        9.44269635e-02,
                        6.03267957e-03,
                        6.24164661e-02,
                        3.03002215e-02,
                        1.03115286e-02,
                        1.29982477e-02,
                        4.77017034e-03,
                        3.23152608e-02,
                        3.82598073e-02,
                        4.98696799e-02,
                        2.96036647e-01,
                        1.04856678e-02,
                        1.12294910e-01,
                    ],
                    [
                        6.88920197e-03,
                        2.84911110e-04,
                        3.30702229e-03,
                        1.67969216e-03,
                        1.39796385e-02,
                        6.75778351e-03,
                        1.10986995e-03,
                        1.37784039e-03,
                        9.95905501e-04,
                        3.64302420e-03,
                        2.50105753e-03,
                        1.20369353e-03,
                        1.51732176e-03,
                        1.57496808e-03,
                        5.33476802e-03,
                        3.15806203e-03,
                        2.91071350e-03,
                        3.05445244e-03,
                        8.86286080e-01,
                        5.24339936e-02,
                    ],
                    [
                        1.78004372e-02,
                        1.04108487e-03,
                        1.20840878e-02,
                        4.34001718e-03,
                        7.22416551e-02,
                        1.23467038e-02,
                        1.14708033e-02,
                        5.03472394e-03,
                        2.57323757e-03,
                        9.41290787e-03,
                        6.46227497e-03,
                        4.39837927e-03,
                        3.92048176e-03,
                        2.87752106e-03,
                        1.94936107e-02,
                        1.15397767e-02,
                        7.52075104e-03,
                        1.11611801e-02,
                        1.78906332e-02,
                        7.66389733e-01,
                    ],
                ]
            )

        elif self.cluster_pc == 62:
            prob_matrix = tf.constant(
                [
                    [
                        0.39203775,
                        0.00810659,
                        0.04704745,
                        0.01689716,
                        0.02486022,
                        0.09613981,
                        0.0078948,
                        0.01386063,
                        0.01001849,
                        0.0259138,
                        0.01257991,
                        0.01210877,
                        0.02158622,
                        0.00792183,
                        0.05366604,
                        0.08985653,
                        0.04140935,
                        0.04345426,
                        0.00870679,
                        0.06593362,
                    ],
                    [
                        0.14502489,
                        0.27142384,
                        0.04922614,
                        0.00883982,
                        0.03678575,
                        0.05029594,
                        0.00826039,
                        0.02050962,
                        0.00741219,
                        0.03834473,
                        0.01861454,
                        0.0126695,
                        0.0159706,
                        0.00586098,
                        0.03970491,
                        0.0664805,
                        0.04332695,
                        0.04546655,
                        0.01821997,
                        0.0975622,
                    ],
                    [
                        0.0392825,
                        0.0022975,
                        0.60341668,
                        0.03831068,
                        0.0140913,
                        0.0544941,
                        0.00894988,
                        0.00555538,
                        0.00803088,
                        0.00734425,
                        0.00504207,
                        0.02745403,
                        0.01730366,
                        0.00898053,
                        0.03041906,
                        0.0509326,
                        0.02347171,
                        0.0123154,
                        0.00493519,
                        0.03737259,
                    ],
                    [
                        0.08074968,
                        0.00236138,
                        0.21927242,
                        0.157504,
                        0.02048226,
                        0.05600943,
                        0.01839751,
                        0.00807497,
                        0.02334641,
                        0.01509694,
                        0.01036455,
                        0.02821745,
                        0.02515154,
                        0.0261071,
                        0.08843057,
                        0.07403252,
                        0.03411704,
                        0.02531572,
                        0.01014486,
                        0.07682364,
                    ],
                    [
                        0.04243806,
                        0.00351015,
                        0.0288097,
                        0.00731646,
                        0.34446294,
                        0.0294358,
                        0.00966882,
                        0.01697522,
                        0.004338,
                        0.03173684,
                        0.01540672,
                        0.00741485,
                        0.00660921,
                        0.00343015,
                        0.02323738,
                        0.027512,
                        0.01793024,
                        0.02660939,
                        0.03016029,
                        0.32299776,
                    ],
                    [
                        0.07885168,
                        0.00230588,
                        0.05352962,
                        0.00961262,
                        0.01414272,
                        0.61878001,
                        0.00635161,
                        0.00394258,
                        0.00569941,
                        0.00737105,
                        0.00506047,
                        0.01948377,
                        0.01228018,
                        0.00450665,
                        0.03053005,
                        0.05111845,
                        0.01665756,
                        0.01236034,
                        0.0099064,
                        0.03750896,
                    ],
                    [
                        0.04848979,
                        0.002836,
                        0.06583601,
                        0.0236451,
                        0.03478823,
                        0.0475648,
                        0.24997895,
                        0.00685749,
                        0.00991321,
                        0.01282075,
                        0.00880187,
                        0.03388889,
                        0.01510338,
                        0.01108544,
                        0.07509775,
                        0.04445617,
                        0.02048712,
                        0.01520197,
                        0.01218387,
                        0.26096323,
                    ],
                    [
                        0.09706068,
                        0.00802812,
                        0.04659202,
                        0.01183244,
                        0.06963465,
                        0.03366152,
                        0.00781838,
                        0.10981163,
                        0.00701556,
                        0.10265178,
                        0.03523693,
                        0.01199155,
                        0.01511601,
                        0.00554736,
                        0.03758028,
                        0.04449335,
                        0.0410085,
                        0.17213445,
                        0.01219406,
                        0.13059074,
                    ],
                    [
                        0.09001357,
                        0.00372262,
                        0.0864184,
                        0.04389336,
                        0.02283206,
                        0.06243504,
                        0.01450144,
                        0.00900136,
                        0.10409916,
                        0.02379968,
                        0.01633927,
                        0.03145466,
                        0.02803701,
                        0.02057836,
                        0.19715129,
                        0.0825258,
                        0.03803107,
                        0.02822003,
                        0.01130871,
                        0.08563712,
                    ],
                    [
                        0.09819495,
                        0.00812194,
                        0.03333054,
                        0.01197071,
                        0.07044841,
                        0.03405489,
                        0.00790974,
                        0.05554745,
                        0.01003745,
                        0.20770277,
                        0.0504149,
                        0.01213169,
                        0.01529266,
                        0.00793683,
                        0.05376762,
                        0.04501331,
                        0.04148773,
                        0.08707302,
                        0.01744654,
                        0.13211685,
                    ],
                    [
                        0.09093785,
                        0.00752169,
                        0.04365288,
                        0.01567799,
                        0.06524192,
                        0.04460156,
                        0.01035936,
                        0.03637514,
                        0.01314601,
                        0.09617625,
                        0.1320564,
                        0.01588882,
                        0.02002873,
                        0.01470051,
                        0.07041924,
                        0.05895375,
                        0.03842158,
                        0.08063789,
                        0.02284966,
                        0.12235275,
                    ],
                    [
                        0.05428932,
                        0.00317519,
                        0.14742039,
                        0.02647312,
                        0.0194745,
                        0.10650739,
                        0.02473788,
                        0.00767767,
                        0.01569617,
                        0.01435415,
                        0.0098546,
                        0.21463293,
                        0.01690979,
                        0.0124113,
                        0.08407967,
                        0.09954652,
                        0.04587488,
                        0.01702017,
                        0.00682055,
                        0.07304381,
                    ],
                    [
                        0.08504807,
                        0.00351726,
                        0.08165122,
                        0.02073601,
                        0.0152541,
                        0.05899088,
                        0.00968841,
                        0.00850481,
                        0.01229458,
                        0.01590057,
                        0.01091627,
                        0.01485975,
                        0.42384614,
                        0.00972159,
                        0.04656891,
                        0.05513549,
                        0.03593313,
                        0.0266633,
                        0.00755535,
                        0.05721416,
                    ],
                    [
                        0.08715285,
                        0.00360431,
                        0.11832997,
                        0.06010178,
                        0.02210643,
                        0.06045078,
                        0.01985636,
                        0.00871528,
                        0.02519769,
                        0.0230433,
                        0.02237285,
                        0.030455,
                        0.02714597,
                        0.07969745,
                        0.13497651,
                        0.07990304,
                        0.0368224,
                        0.02732317,
                        0.01548466,
                        0.11726019,
                    ],
                    [
                        0.07375907,
                        0.00305039,
                        0.05007243,
                        0.02543263,
                        0.01870908,
                        0.05116062,
                        0.01680481,
                        0.00737591,
                        0.03015849,
                        0.01950197,
                        0.01338876,
                        0.02577463,
                        0.01624517,
                        0.01686236,
                        0.4569325,
                        0.04781698,
                        0.03116348,
                        0.01635121,
                        0.0092666,
                        0.07017291,
                    ],
                    [
                        0.14155724,
                        0.00585427,
                        0.09609821,
                        0.02440495,
                        0.0253895,
                        0.09818665,
                        0.01140264,
                        0.01000961,
                        0.01446993,
                        0.01871394,
                        0.01284774,
                        0.03497793,
                        0.0220458,
                        0.01144168,
                        0.0548086,
                        0.25956362,
                        0.05980846,
                        0.02218971,
                        0.00889216,
                        0.06733737,
                    ],
                    [
                        0.11092465,
                        0.00648759,
                        0.07530283,
                        0.01912379,
                        0.02813618,
                        0.05440433,
                        0.00893514,
                        0.01568711,
                        0.01133867,
                        0.02932859,
                        0.01423763,
                        0.0274088,
                        0.02443075,
                        0.00896574,
                        0.06073789,
                        0.10169739,
                        0.26511458,
                        0.04918045,
                        0.01393584,
                        0.07462204,
                    ],
                    [
                        0.12754851,
                        0.00745986,
                        0.04329409,
                        0.01554913,
                        0.04575383,
                        0.04423497,
                        0.00726497,
                        0.07215233,
                        0.00921923,
                        0.06744791,
                        0.03274275,
                        0.01114275,
                        0.01986411,
                        0.00728984,
                        0.03492022,
                        0.04134397,
                        0.05388972,
                        0.22620377,
                        0.01133093,
                        0.12134711,
                    ],
                    [
                        0.02011519,
                        0.00235293,
                        0.01365549,
                        0.00490439,
                        0.04081795,
                        0.02790452,
                        0.00458292,
                        0.00402304,
                        0.00290786,
                        0.01063695,
                        0.00730262,
                        0.00351456,
                        0.0044303,
                        0.00325171,
                        0.01557653,
                        0.0130404,
                        0.01201904,
                        0.00891843,
                        0.64694766,
                        0.15309752,
                    ],
                    [
                        0.02382287,
                        0.00197045,
                        0.01617251,
                        0.00580838,
                        0.06836536,
                        0.01652397,
                        0.01535173,
                        0.00673813,
                        0.00344384,
                        0.01259758,
                        0.00611553,
                        0.00588649,
                        0.0052469,
                        0.00385107,
                        0.01844764,
                        0.01544404,
                        0.01006525,
                        0.01493735,
                        0.02394358,
                        0.72526733,
                    ],
                ]
            )

        elif self.cluster_pc == 80:
            prob_matrix = tf.constant(
                [
                    [
                        0.49266312,
                        0.00509367,
                        0.04180645,
                        0.01501484,
                        0.01562058,
                        0.08543,
                        0.00701533,
                        0.00870914,
                        0.00890244,
                        0.01628258,
                        0.01117853,
                        0.01075987,
                        0.01918156,
                        0.00703936,
                        0.03372032,
                        0.07984667,
                        0.03679642,
                        0.03861353,
                        0.00773687,
                        0.05858873,
                    ],
                    [
                        0.12562197,
                        0.33249572,
                        0.04264016,
                        0.00765714,
                        0.03186417,
                        0.04356683,
                        0.00715523,
                        0.01776563,
                        0.00642051,
                        0.03321458,
                        0.0161241,
                        0.01552021,
                        0.01383389,
                        0.00507684,
                        0.03439278,
                        0.05758606,
                        0.05307575,
                        0.05569678,
                        0.01578231,
                        0.08450933,
                    ],
                    [
                        0.04267497,
                        0.00176487,
                        0.65552828,
                        0.02942924,
                        0.01082456,
                        0.0418609,
                        0.00687506,
                        0.0042675,
                        0.00872444,
                        0.00564165,
                        0.00387318,
                        0.02982499,
                        0.0132922,
                        0.0068986,
                        0.03304607,
                        0.03912506,
                        0.02549874,
                        0.00946036,
                        0.0026807,
                        0.02870862,
                    ],
                    [
                        0.09005055,
                        0.00186207,
                        0.17290779,
                        0.24840031,
                        0.01615133,
                        0.04416637,
                        0.02051656,
                        0.00636754,
                        0.02603548,
                        0.01190473,
                        0.01155836,
                        0.02225094,
                        0.01983331,
                        0.02911416,
                        0.06973214,
                        0.0825597,
                        0.03804669,
                        0.01996277,
                        0.00799975,
                        0.06057946,
                    ],
                    [
                        0.03221874,
                        0.00266489,
                        0.02187217,
                        0.00555462,
                        0.36983723,
                        0.0223475,
                        0.00734052,
                        0.0128875,
                        0.00329339,
                        0.03407468,
                        0.01654163,
                        0.00562932,
                        0.00709606,
                        0.00260415,
                        0.01764169,
                        0.02088697,
                        0.01925104,
                        0.02856953,
                        0.02289753,
                        0.34679085,
                    ],
                    [
                        0.08576299,
                        0.00177342,
                        0.04116879,
                        0.00739291,
                        0.01087695,
                        0.6730158,
                        0.00488493,
                        0.00303218,
                        0.00619896,
                        0.00801711,
                        0.00389193,
                        0.01498466,
                        0.00944449,
                        0.00490166,
                        0.02348019,
                        0.0393144,
                        0.01811759,
                        0.00950614,
                        0.00538735,
                        0.02884755,
                    ],
                    [
                        0.05180653,
                        0.00214252,
                        0.04973735,
                        0.02526244,
                        0.02628158,
                        0.03593394,
                        0.2670777,
                        0.00518065,
                        0.01059129,
                        0.0136977,
                        0.00940393,
                        0.02560215,
                        0.0114102,
                        0.01674952,
                        0.08023449,
                        0.047497,
                        0.02188845,
                        0.01148468,
                        0.00920459,
                        0.2788133,
                    ],
                    [
                        0.07836861,
                        0.00648205,
                        0.03761927,
                        0.00955373,
                        0.05622431,
                        0.02717894,
                        0.0063127,
                        0.17732791,
                        0.00801081,
                        0.08288296,
                        0.04023573,
                        0.0096822,
                        0.01220495,
                        0.00633432,
                        0.0429115,
                        0.03592476,
                        0.04682606,
                        0.19655385,
                        0.01392394,
                        0.1054414,
                    ],
                    [
                        0.09787974,
                        0.00286232,
                        0.09397038,
                        0.04772914,
                        0.01755557,
                        0.06789115,
                        0.0157687,
                        0.00978797,
                        0.11319624,
                        0.01829957,
                        0.01256327,
                        0.03420344,
                        0.03048713,
                        0.02237668,
                        0.21438007,
                        0.06345408,
                        0.04135455,
                        0.02169838,
                        0.00869527,
                        0.06584637,
                    ],
                    [
                        0.08161783,
                        0.0067508,
                        0.02770373,
                        0.00994983,
                        0.08280986,
                        0.04003044,
                        0.00929765,
                        0.04617001,
                        0.00834294,
                        0.24414799,
                        0.05926111,
                        0.01008363,
                        0.01797603,
                        0.00659695,
                        0.04469065,
                        0.03741423,
                        0.03448384,
                        0.10235156,
                        0.02050785,
                        0.10981308,
                    ],
                    [
                        0.09758791,
                        0.00570757,
                        0.03312449,
                        0.01682449,
                        0.0700129,
                        0.03384437,
                        0.01111691,
                        0.03903517,
                        0.0099754,
                        0.10320938,
                        0.20041295,
                        0.01205669,
                        0.01519812,
                        0.01577553,
                        0.05343523,
                        0.04473503,
                        0.04123126,
                        0.08653474,
                        0.01733868,
                        0.09284319,
                    ],
                    [
                        0.06359689,
                        0.00371956,
                        0.17269473,
                        0.02192864,
                        0.01613143,
                        0.0882239,
                        0.02049128,
                        0.00635969,
                        0.01838718,
                        0.01189006,
                        0.00816292,
                        0.25143045,
                        0.01400698,
                        0.01453914,
                        0.06964621,
                        0.08245797,
                        0.05373985,
                        0.01409842,
                        0.00798989,
                        0.06050481,
                    ],
                    [
                        0.07917077,
                        0.00231521,
                        0.05374624,
                        0.01364931,
                        0.01419995,
                        0.03883025,
                        0.00637732,
                        0.00559822,
                        0.01144495,
                        0.01480175,
                        0.00718554,
                        0.00978131,
                        0.5579864,
                        0.00639916,
                        0.04335074,
                        0.05132531,
                        0.02365268,
                        0.0175509,
                        0.00497325,
                        0.03766074,
                    ],
                    [
                        0.0929665,
                        0.00271864,
                        0.08925338,
                        0.06411096,
                        0.01667433,
                        0.06448324,
                        0.02995433,
                        0.00929665,
                        0.02687854,
                        0.01738099,
                        0.02386526,
                        0.03248654,
                        0.02047553,
                        0.12022764,
                        0.14398031,
                        0.08523309,
                        0.03927869,
                        0.02060919,
                        0.0116797,
                        0.08844647,
                    ],
                    [
                        0.04748288,
                        0.00196371,
                        0.04558639,
                        0.01637242,
                        0.01204409,
                        0.03293498,
                        0.01529925,
                        0.00671509,
                        0.02745657,
                        0.01255452,
                        0.0086191,
                        0.01659258,
                        0.01478975,
                        0.01535164,
                        0.58830649,
                        0.04353302,
                        0.02837152,
                        0.01488629,
                        0.00596543,
                        0.04517426,
                    ],
                    [
                        0.13985166,
                        0.00408972,
                        0.06713297,
                        0.0241109,
                        0.01773678,
                        0.06859193,
                        0.01126525,
                        0.00699258,
                        0.0101085,
                        0.01307332,
                        0.00897527,
                        0.02443513,
                        0.02178018,
                        0.01130383,
                        0.05414823,
                        0.36265558,
                        0.05908785,
                        0.02192235,
                        0.00621195,
                        0.06652604,
                    ],
                    [
                        0.11350272,
                        0.00663837,
                        0.07705298,
                        0.01956825,
                        0.02879011,
                        0.05566877,
                        0.0091428,
                        0.01605171,
                        0.0116022,
                        0.02122044,
                        0.01456854,
                        0.02804583,
                        0.01767665,
                        0.00917411,
                        0.06214953,
                        0.104061,
                        0.27127626,
                        0.05032348,
                        0.00712987,
                        0.07635637,
                    ],
                    [
                        0.13890808,
                        0.00812424,
                        0.03334001,
                        0.01197411,
                        0.0498287,
                        0.03406457,
                        0.00559462,
                        0.07857828,
                        0.00709956,
                        0.07345488,
                        0.03565885,
                        0.00858083,
                        0.015297,
                        0.00561378,
                        0.03803025,
                        0.04502609,
                        0.05868918,
                        0.24634965,
                        0.01234007,
                        0.09344725,
                    ],
                    [
                        0.02130474,
                        0.00176217,
                        0.00723152,
                        0.00367301,
                        0.0305695,
                        0.01477735,
                        0.00343225,
                        0.00426095,
                        0.00217776,
                        0.01126599,
                        0.0054691,
                        0.0037224,
                        0.00331795,
                        0.00243528,
                        0.01166562,
                        0.00976625,
                        0.0063649,
                        0.00944584,
                        0.68520617,
                        0.16215124,
                    ],
                    [
                        0.02467375,
                        0.00144308,
                        0.01184414,
                        0.00425384,
                        0.07080716,
                        0.01210154,
                        0.01590004,
                        0.00493475,
                        0.00252214,
                        0.009226,
                        0.00447878,
                        0.00431104,
                        0.00384263,
                        0.00282038,
                        0.01351036,
                        0.01599565,
                        0.01042475,
                        0.01093955,
                        0.02479877,
                        0.75117164,
                    ],
                ]
            )

        elif self.cluster_pc == 90:
            prob_matrix = tf.constant(
                [
                    [
                        5.16556379e-01,
                        5.34070027e-03,
                        3.09953073e-02,
                        1.57430372e-02,
                        1.63781475e-02,
                        8.95732017e-02,
                        7.35556298e-03,
                        9.13151296e-03,
                        9.33419687e-03,
                        1.70722549e-02,
                        8.28776661e-03,
                        1.12817053e-02,
                        2.01118262e-02,
                        7.38075154e-03,
                        3.53556940e-02,
                        8.37190853e-02,
                        3.85809825e-02,
                        2.86280780e-02,
                        5.73611433e-03,
                        4.34376955e-02,
                    ],
                    [
                        1.38453897e-01,
                        3.66459198e-01,
                        3.32309988e-02,
                        5.96748004e-03,
                        3.51190064e-02,
                        4.80170582e-02,
                        5.57632873e-03,
                        1.95803379e-02,
                        7.07635164e-03,
                        3.66073531e-02,
                        1.77711264e-02,
                        1.20954547e-02,
                        1.52469845e-02,
                        5.59542444e-03,
                        2.68035190e-02,
                        6.34683085e-02,
                        4.13638286e-02,
                        4.34064869e-02,
                        1.22997205e-02,
                        6.58611367e-02,
                    ],
                    [
                        2.45275413e-02,
                        1.01436553e-03,
                        7.53532859e-01,
                        2.39207497e-02,
                        6.22144193e-03,
                        3.40254887e-02,
                        5.58820318e-03,
                        2.45275413e-03,
                        7.09142030e-03,
                        4.58566328e-03,
                        3.14821067e-03,
                        2.42424224e-02,
                        7.63972599e-03,
                        5.60733955e-03,
                        1.89933092e-02,
                        3.18017302e-02,
                        1.46554635e-02,
                        5.43736479e-03,
                        2.17893399e-03,
                        2.33350131e-02,
                    ],
                    [
                        9.64720887e-02,
                        1.41057816e-03,
                        1.85237912e-01,
                        2.66113830e-01,
                        1.22351338e-02,
                        4.73158933e-02,
                        1.55419267e-02,
                        6.82160681e-03,
                        1.97226784e-02,
                        1.27536598e-02,
                        8.75581252e-03,
                        2.38376637e-02,
                        2.12476278e-02,
                        3.11902976e-02,
                        7.47047650e-02,
                        6.25415180e-02,
                        4.07598169e-02,
                        2.13863237e-02,
                        6.06005744e-03,
                        4.58908095e-02,
                    ],
                    [
                        2.87728558e-02,
                        2.37987108e-03,
                        1.38118284e-02,
                        3.50762981e-03,
                        4.67089364e-01,
                        1.41119923e-02,
                        6.55542934e-03,
                        1.15091423e-02,
                        2.94115007e-03,
                        3.04302909e-02,
                        1.04457044e-02,
                        5.02724414e-03,
                        6.33711717e-03,
                        2.32563104e-03,
                        1.57548616e-02,
                        1.86530436e-02,
                        1.21566388e-02,
                        1.80410752e-02,
                        2.04485733e-02,
                        3.09700557e-01,
                    ],
                    [
                        8.78277919e-02,
                        1.81611120e-03,
                        4.21599579e-02,
                        7.57090418e-03,
                        7.87633185e-03,
                        6.89219107e-01,
                        5.00253510e-03,
                        3.10518136e-03,
                        6.34820850e-03,
                        5.80543967e-03,
                        3.98562781e-03,
                        1.53454268e-02,
                        9.67187637e-03,
                        3.54943980e-03,
                        2.40454878e-02,
                        4.02609208e-02,
                        1.31195069e-02,
                        6.88369191e-03,
                        5.51705131e-03,
                        2.08894019e-02,
                    ],
                    [
                        5.82335999e-02,
                        1.70293906e-03,
                        5.59077273e-02,
                        2.00793391e-02,
                        2.95420528e-02,
                        4.03918736e-02,
                        3.00211131e-01,
                        5.82335999e-03,
                        1.19052316e-02,
                        1.08873399e-02,
                        7.47452172e-03,
                        2.87783334e-02,
                        1.28257392e-02,
                        1.88274488e-02,
                        9.01883115e-02,
                        3.77520357e-02,
                        2.46039129e-02,
                        1.29094605e-02,
                        1.03465054e-02,
                        2.21609137e-01,
                    ],
                    [
                        8.09481591e-02,
                        6.69541405e-03,
                        2.74764223e-02,
                        9.86819584e-03,
                        5.80749715e-02,
                        2.80735504e-02,
                        6.52048882e-03,
                        1.83164775e-01,
                        5.85094741e-03,
                        8.56111067e-02,
                        4.15601148e-02,
                        1.00008977e-02,
                        1.26066805e-02,
                        4.62647079e-03,
                        3.13417760e-02,
                        3.71072453e-02,
                        4.83673749e-02,
                        2.03023549e-01,
                        1.01697911e-02,
                        1.08912069e-01,
                    ],
                    [
                        9.60957395e-02,
                        2.81015065e-03,
                        9.22576384e-02,
                        3.31344610e-02,
                        1.72355906e-02,
                        6.66537354e-02,
                        1.54812957e-02,
                        6.79499490e-03,
                        1.57165903e-01,
                        1.79660365e-02,
                        1.23342828e-02,
                        3.35800344e-02,
                        2.11647382e-02,
                        2.19688322e-02,
                        2.10472689e-01,
                        6.22975360e-02,
                        4.06008080e-02,
                        2.13028931e-02,
                        6.03641642e-03,
                        6.46462247e-02,
                    ],
                    [
                        7.80709235e-02,
                        6.45743108e-03,
                        2.64997956e-02,
                        9.51743896e-03,
                        7.92111546e-02,
                        2.70756992e-02,
                        6.28872342e-03,
                        4.41635836e-02,
                        7.98037929e-03,
                        3.30272522e-01,
                        5.66857734e-02,
                        9.64542408e-03,
                        1.21585865e-02,
                        6.31025868e-03,
                        4.27485060e-02,
                        3.57882989e-02,
                        3.29852561e-02,
                        6.92283152e-02,
                        1.38710510e-02,
                        1.05040879e-01,
                    ],
                    [
                        6.89778057e-02,
                        5.70531776e-03,
                        3.31114027e-02,
                        1.18920070e-02,
                        4.94870315e-02,
                        3.38309923e-02,
                        7.85773811e-03,
                        3.90197393e-02,
                        9.97145626e-03,
                        1.03168593e-01,
                        2.83314709e-01,
                        1.20519240e-02,
                        1.51921116e-02,
                        1.57692927e-02,
                        5.34141100e-02,
                        4.47173554e-02,
                        4.12149631e-02,
                        6.11651183e-02,
                        1.73318302e-02,
                        9.28065022e-02,
                    ],
                    [
                        5.77777327e-02,
                        2.38946659e-03,
                        1.56893044e-01,
                        1.99221531e-02,
                        1.46553951e-02,
                        8.01513518e-02,
                        1.86163127e-02,
                        5.77777327e-03,
                        1.67047394e-02,
                        1.08021111e-02,
                        7.41600930e-03,
                        3.23040878e-01,
                        1.27253362e-02,
                        1.32087991e-02,
                        6.32735375e-02,
                        7.49130067e-02,
                        4.88226147e-02,
                        1.28084020e-02,
                        5.13275521e-03,
                        5.49685813e-02,
                    ],
                    [
                        8.34394804e-02,
                        2.44004064e-03,
                        4.00534376e-02,
                        1.43852486e-02,
                        1.49655826e-02,
                        4.09238942e-02,
                        6.72116828e-03,
                        5.90006224e-03,
                        8.52915108e-03,
                        1.10307423e-02,
                        7.57297222e-03,
                        1.03086929e-02,
                        5.88071778e-01,
                        6.74418441e-03,
                        3.23063741e-02,
                        3.82492858e-02,
                        2.49279828e-02,
                        1.84972023e-02,
                        5.24139210e-03,
                        3.96913278e-02,
                    ],
                    [
                        9.51238404e-02,
                        2.78172917e-03,
                        9.13245574e-02,
                        6.55986872e-02,
                        1.70612723e-02,
                        4.66546287e-02,
                        3.06494401e-02,
                        6.72627126e-03,
                        2.75022728e-02,
                        1.77843305e-02,
                        2.44190712e-02,
                        3.32404106e-02,
                        2.09506810e-02,
                        1.73973140e-01,
                        1.47321453e-01,
                        6.16674673e-02,
                        4.01901770e-02,
                        2.10874385e-02,
                        1.19507299e-02,
                        6.39924017e-02,
                    ],
                    [
                        4.88776284e-02,
                        1.42934016e-03,
                        3.31812947e-02,
                        1.68533369e-02,
                        1.23978724e-02,
                        3.39024033e-02,
                        1.57486487e-02,
                        4.88776284e-03,
                        2.82630698e-02,
                        1.29232953e-02,
                        8.87227294e-03,
                        1.70799710e-02,
                        1.07651205e-02,
                        1.58025787e-02,
                        6.05587261e-01,
                        4.48117454e-02,
                        2.06509801e-02,
                        1.53235566e-02,
                        6.14066181e-03,
                        4.65011998e-02,
                    ],
                    [
                        1.45608521e-01,
                        4.25806475e-03,
                        6.98964303e-02,
                        1.77507855e-02,
                        1.84668929e-02,
                        7.14154461e-02,
                        8.29363602e-03,
                        7.28042606e-03,
                        1.05246100e-02,
                        1.36114672e-02,
                        9.34472588e-03,
                        2.54409778e-02,
                        1.60348744e-02,
                        8.32203695e-03,
                        5.63771890e-02,
                        3.77583945e-01,
                        6.15201427e-02,
                        2.28247615e-02,
                        6.46765510e-03,
                        4.89774117e-02,
                    ],
                    [
                        1.10178235e-01,
                        4.55655146e-03,
                        5.28888369e-02,
                        1.89951004e-02,
                        1.97614064e-02,
                        3.82108040e-02,
                        8.87501284e-03,
                        1.55815555e-02,
                        1.12623761e-02,
                        2.05988966e-02,
                        1.41418290e-02,
                        2.72243687e-02,
                        1.71589055e-02,
                        8.90540464e-03,
                        4.26591736e-02,
                        1.01013064e-01,
                        3.72405719e-01,
                        3.45418237e-02,
                        6.92103221e-03,
                        7.41199037e-02,
                    ],
                    [
                        1.03597333e-01,
                        6.05904310e-03,
                        2.48649039e-02,
                        1.26293023e-02,
                        3.71621310e-02,
                        2.54052775e-02,
                        5.90074378e-03,
                        8.28778667e-02,
                        7.48803378e-03,
                        5.47824834e-02,
                        2.65942865e-02,
                        9.05035447e-03,
                        1.61340109e-02,
                        5.92095042e-03,
                        4.01111583e-02,
                        4.74897973e-02,
                        4.37702593e-02,
                        3.67454029e-01,
                        1.30152835e-02,
                        6.96927515e-02,
                    ],
                    [
                        1.52802977e-02,
                        1.26386963e-03,
                        7.33499833e-03,
                        2.63437500e-03,
                        3.10069349e-02,
                        1.49888106e-02,
                        3.48136843e-03,
                        3.05605954e-03,
                        1.56194606e-03,
                        8.08025290e-03,
                        5.54736291e-03,
                        2.66980058e-03,
                        3.36543016e-03,
                        2.47012913e-03,
                        1.18325524e-02,
                        9.90600520e-03,
                        6.45598270e-03,
                        9.58100932e-03,
                        6.95011247e-01,
                        1.64471568e-01,
                    ],
                    [
                        1.35738913e-02,
                        7.93889090e-04,
                        9.21483516e-03,
                        2.34018478e-03,
                        5.50885557e-02,
                        6.65747786e-03,
                        8.74716932e-03,
                        3.83927625e-03,
                        1.96224659e-03,
                        7.17790172e-03,
                        3.48452941e-03,
                        3.35402561e-03,
                        2.98960036e-03,
                        1.55159086e-03,
                        1.05111683e-02,
                        8.79976563e-03,
                        8.11054259e-03,
                        6.01823051e-03,
                        1.92936505e-02,
                        8.26491468e-01,
                    ],
                ]
            )

        else:
            raise ValueError("Expected cluster pc to be one of 45, 50, 62, 80 and 90.")

        if self.reorder_vocab is not None:
            # Rearrange matrix to correct order
            prob_matrix = tf.gather(
                params=prob_matrix, indices=tf.argsort(self.reorder_vocab)
            )

            # Rearrange residue probabilities to correct order
            prob_matrix = tf.gather(
                params=prob_matrix, indices=tf.argsort(self.reorder_vocab), axis=-1
            )

        return prob_matrix

    def get_config(self):
        """
        Returns a dictionary containing the current configuration of the BlosumInitializer instance.

        Returns
        -------
        dict
            A dictionary containing the current configuration of the BlosumInitializer instance.
        """
        config = super().get_config()
        config.update(
            {"cluster_pc": self.cluster_pc, "reorder_vocab": self.reorder_vocab}
        )

        return config
